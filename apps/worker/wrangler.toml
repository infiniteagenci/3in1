name = "3in1-worker"
main = "src/index.ts"
compatibility_date = "2025-01-21"
compatibility_flags = ["nodejs_compat"]

# Production environment configuration
[env.production]
name = "3in1-worker"

[[env.production.d1_databases]]
binding = "DB"
database_name = "3in1"
database_id = "ea691e25-4a91-4ce2-a192-8b5b03393be4"

[[env.production.kv_namespaces]]
binding = "CACHE"
id = "your-kv-namespace-id-here"

# Staging environment configuration
[env.staging]
name = "3in1-worker-staging"

[[env.staging.d1_databases]]
binding = "DB"
database_name = "3in1-db-staging"
database_id = "your-staging-database-id-here"

[[env.staging.kv_namespaces]]
binding = "CACHE"
id = "your-staging-kv-namespace-id-here"

# Development environment configuration (local)
[env.development]
name = "3in1-worker-dev"
vars = { ENVIRONMENT = "development" }

[[env.development.d1_databases]]
binding = "DB"
database_name = "3in1-dev"
database_id = "fcb0d78a-2431-4210-b0fd-d0f2bc36a9ee"

# Configure D1 database migrations (disable for now to avoid DurableObject warnings)
# [[migrations]]
# tag = "0001_initial_schema"
# new_classes = ["users", "sessions", "profiles", "conversations", "notes"]

# Configure additional worker settings
[build]
command = ""
watch_dir = "src"

# Configure limits and timeouts
[limits]
cpu_ms = 50000
